theme(rect = element_rect(fill = grey15K, colour = grey15K, linetype = 1, size =0),
panel.background = element_rect(fill= grey15K))
ggplot(df2 %>% filter(ByVariableLabel != 'Total'),
aes(x = 100 - PR_DESL_M_WNM, y = diffVal,
group = ByVariableLabel,
colour = ByVariableLabel)) +
geom_point(size = 3) +
facet_wrap(~CountryName) +
theme_basic() +
theme(rect = element_rect(fill = grey15K, colour = grey15K, linetype = 1, size =0),
panel.background = element_rect(fill= grey15K))
ggplot(df2 %>% filter(ByVariableLabel != 'Total'),
aes(x = 100 - PR_DESL_M_WNM, y = 100 - PR_DESL_W_WNM,
group = ByVariableLabel,
colour = ByVariableLabel)) +
geom_abline(slope = 1, intercept = 0,
colour = grey40K, size = 0.5) +
geom_point(size = 3) +
facet_wrap(~CountryName) +
coord_cartesian(xlim = c(0, 100), ylim = c(0, 100))+
theme_xygrid()
ggplot(df2 %>% filter(CountryName == 'Ghana',
ByVariableLabel != 'Total'),
aes(x = PR_DESL_M_WNM, y = diffVal,
group = ByVariableLabel,
colour = ByVariableLabel)) +
geom_point(size = 3) +
facet_wrap(~SurveyYear) +
theme_xygrid() +
theme(rect = element_rect(fill = grey15K, colour = grey15K, linetype = 1, size =0),
panel.background = element_rect(fill= grey15K))
order = df2 %>%
filter(ByVariableLabel=='Total') %>%
arrange(desc(diffVal)) %>%
select(CountryName)
order = unique(order$CountryName)
df2$CountryName = factor(df2$CountryName, levels = order)
ggplot(df2 %>% filter(ByVariableLabel == 'Total'),
aes(x = SurveyYear, y = diffVal,
group = CountryName)) +
geom_area(fill = 'dodgerblue') +
geom_bar(fill = 'dodgerblue', stat='identity') +
facet_wrap(~CountryName) +
theme_xygrid()
df = natl %>%
filter(IndicatorId %in% c('FP_NADM_W_UNT', 'PR_DESL_W_WNM',
'FP_CUSA_W_MOD'),
SurveyYear > 2010,
ByVariableLabel == 'Total' | ByVariableLabel == "") %>%
select(CountryName, IndicatorId, Value, SurveyYear) %>%
spread(IndicatorId, Value)
ggplot(df, aes(x = FP_CUSA_W_MOD, y = PR_DESL_W_WNM,
colour = FP_NADM_W_UNT,
label = CountryName)) +
geom_label(nudge_y = 2) +
geom_point(size = 5) +
xlab('modern contraception use') +
ylab('desires for no more children')+
scale_colour_gradientn(colours = brewer.pal(9, 'RdPu'),
limits = c(15, 35)) +
theme_xygrid()
View(subnatl)
df = subnatl %>%
filter(country %in% c(),
IndicatorId %in% c('FP_NADM_W_UNT', 'PR_DESL_W_WNM',
'FP_CUSA_W_MOD'),
SurveyYear > 2010,
ByVariableLabel == 'Total' | ByVariableLabel == "") %>%
select(CountryName, IndicatorId, Value, SurveyYear, CharacteristicLabel,
ByVariableLabel) %>%
spread(IndicatorId, Value)
df = subnatl %>%
filter(CountryName %in% c('Benin', 'Ghana', 'Senegal', 'Togo'),
IndicatorId %in% c('FP_NADM_W_UNT', 'PR_DESL_W_WNM',
'FP_CUSA_W_MOD'),
SurveyYear > 2010,
ByVariableLabel == 'Total' | ByVariableLabel == "") %>%
select(CountryName, IndicatorId, Value, SurveyYear, CharacteristicLabel,
ByVariableLabel) %>%
spread(IndicatorId, Value)
df = subnatl %>%
filter(CountryName %in% c('Benin', 'Ghana', 'Senegal', 'Togo'),
IndicatorId %in% c('FP_NADM_W_UNT', 'PR_DESL_W_WNM',
'FP_CUSA_W_MOD'),
SurveyYear > 2010,
ByVariableLabel == 'Total' | ByVariableLabel == "") %>%
select(CharacteristicLabel, CountryName, IndicatorId, Value, SurveyYear) %>%
spread(IndicatorId, Value)
df = subnatl %>%
filter(CountryName %in% c('Benin', 'Ghana', 'Senegal', 'Togo'),
IndicatorId %in% c('FP_NADM_W_UNT', 'PR_DESL_W_WNM',
'FP_CUSA_W_MOD'),
SurveyYear > 2010,
ByVariableLabel == 'Total' | ByVariableLabel == "") %>%
select(DataId, CharacteristicLabel, CountryName, IndicatorId, Value, SurveyYear) %>%
spread(IndicatorId, Value)
View(df)
df = subnatl %>%
filter(CountryName %in% c('Benin', 'Ghana', 'Senegal', 'Togo'),
IndicatorId %in% c('FP_NADM_W_UNT', 'PR_DESL_W_WNM',
'FP_CUSA_W_MOD'),
SurveyYear > 2010,
ByVariableLabel == 'Total' | ByVariableLabel == "") %>%
group_by(CountryName, CharacteristicLabel) %>%
mutate(id = nth())
df = subnatl %>%
filter(CountryName %in% c('Benin', 'Ghana', 'Senegal', 'Togo'),
IndicatorId %in% c('FP_NADM_W_UNT', 'PR_DESL_W_WNM',
'FP_CUSA_W_MOD'),
SurveyYear > 2010,
ByVariableLabel == 'Total' | ByVariableLabel == "") %>%
group_by(CountryName, CharacteristicLabel) %>%
mutate(id = row_number())
df = subnatl %>%
filter(CountryName %in% c('Benin', 'Ghana', 'Senegal', 'Togo'),
IndicatorId %in% c('FP_NADM_W_UNT', 'PR_DESL_W_WNM',
'FP_CUSA_W_MOD'),
SurveyYear > 2010,
ByVariableLabel == 'Total' | ByVariableLabel == "") %>%
group_by(CountryName, CharacteristicLabel, IndicatorId) %>%
mutate(id = row_number())
df = subnatl %>%
filter(CountryName %in% c('Benin', 'Ghana', 'Senegal', 'Togo'),
IndicatorId %in% c('FP_NADM_W_UNT', 'PR_DESL_W_WNM',
'FP_CUSA_W_MOD'),
SurveyYear > 2010,
ByVariableLabel == 'Total' | ByVariableLabel == "") %>%
group_by(CountryName, IndicatorId, CharacteristicLabel) %>%
mutate(id = row_number())
df = subnatl %>%
filter(CountryName %in% c('Benin', 'Ghana', 'Senegal', 'Togo'),
IndicatorId %in% c('FP_NADM_W_UNT', 'PR_DESL_W_WNM',
'FP_CUSA_W_MOD'),
SurveyYear > 2010,
ByVariableLabel == 'Total' | ByVariableLabel == "") %>%
group_by(CountryName, IndicatorId, CharacteristicLabel) %>%
mutate(id = row_number(IndicatorId))
df = subnatl %>%
filter(CountryName %in% c('Benin', 'Ghana', 'Senegal', 'Togo'),
IndicatorId %in% c('FP_NADM_W_UNT', 'PR_DESL_W_WNM',
'FP_CUSA_W_MOD'),
SurveyYear > 2010,
ByVariableLabel == 'Total' | ByVariableLabel == "") %>%
group_by(CountryName, IndicatorId, CharacteristicLabel) %>%
mutate(id = id())
df = subnatl %>%
filter(CountryName %in% c('Benin', 'Ghana', 'Senegal', 'Togo'),
IndicatorId %in% c('FP_NADM_W_UNT', 'PR_DESL_W_WNM',
'FP_CUSA_W_MOD'),
SurveyYear > 2010,
ByVariableLabel == 'Total' | ByVariableLabel == "") %>%
group_by(CountryName, IndicatorId, CharacteristicLabel) %>%
mutate(id = id(.variables = c(CountryName, IndicatorId, CharacteristicLabel)))
df = subnatl %>%
filter(CountryName %in% c('Benin', 'Ghana', 'Senegal', 'Togo'),
IndicatorId %in% c('FP_NADM_W_UNT', 'PR_DESL_W_WNM',
'FP_CUSA_W_MOD'),
SurveyYear > 2010,
ByVariableLabel == 'Total' | ByVariableLabel == "") %>%
mutate(id = paste0(DHS_CountryCode, IndicatorId, CharacteristicId)) %>%
select(id, CharacteristicLabel, CountryName, IndicatorId, Value, SurveyYear) %>%
spread(IndicatorId, Value)
df = subnatl %>%
filter(CountryName %in% c('Benin', 'Ghana', 'Senegal', 'Togo'),
IndicatorId %in% c('FP_NADM_W_UNT', 'PR_DESL_W_WNM',
'FP_CUSA_W_MOD'),
SurveyYear > 2010,
ByVariableLabel == 'Total' | ByVariableLabel == "") %>%
mutate(id = paste0(DHS_CountryCode,CharacteristicId)) %>%
select(id, CharacteristicLabel, CountryName, IndicatorId, Value, SurveyYear) %>%
spread(IndicatorId, Value)
ggplot(df, aes(x = FP_CUSA_W_MOD, y = PR_DESL_W_WNM,
colour = FP_NADM_W_UNT,
label = CharacteristicLabel)) +
geom_label(nudge_y = 2) +
geom_point(size = 5) +
xlab('modern contraception use') +
ylab('desires for no more children')+
scale_colour_gradientn(colours = brewer.pal(9, 'RdPu'),
limits = c(15, 35)) +
facet_wrap(~country) +
theme_xygrid()
ggplot(df, aes(x = FP_CUSA_W_MOD, y = PR_DESL_W_WNM,
colour = FP_NADM_W_UNT,
label = id)) +
geom_label(nudge_y = 2) +
geom_point(size = 5) +
xlab('modern contraception use') +
ylab('desires for no more children')+
scale_colour_gradientn(colours = brewer.pal(9, 'RdPu'),
limits = c(15, 35)) +
# facet_wrap(~country) +
theme_xygrid()
ggplot(df, aes(x = FP_CUSA_W_MOD, y = PR_DESL_W_WNM,
# colour = FP_NADM_W_UNT,
label = id)) +
geom_label(nudge_y = 2) +
geom_point(size = 5) +
xlab('modern contraception use') +
ylab('desires for no more children')+
scale_colour_gradientn(colours = brewer.pal(9, 'RdPu'),
limits = c(15, 35)) +
# facet_wrap(~country) +
theme_xygrid()
df = subnatl %>%
filter(CountryName %in% c('Benin', 'Ghana', 'Senegal', 'Togo'),
IndicatorId %in% c('FP_NADM_W_UNT', 'PR_DESL_W_WNM',
'FP_CUSM_W_MOD', 'FP_CUSA_W_MOD'),
SurveyYear > 2010,
ByVariableLabel == 'Total' | ByVariableLabel == "") %>%
mutate(id = paste0(DHS_CountryCode,CharacteristicId)) %>%
select(id, CharacteristicLabel, CountryName, IndicatorId, Value, SurveyYear) %>%
spread(IndicatorId, Value)
ggplot(df, aes(x = FP_CUSM_W_MOD, y = PR_DESL_W_WNM,
colour = FP_NADM_W_UNT,
label = id)) +
geom_label(nudge_y = 2) +
geom_point(size = 5) +
xlab('modern contraception use') +
ylab('desires for no more children')+
scale_colour_gradientn(colours = brewer.pal(9, 'RdPu'),
limits = c(15, 35)) +
# facet_wrap(~country) +
theme_xygrid()
ggplot(df, aes(x = FP_CUSM_W_MOD, y = PR_DESL_W_WNM,
colour = FP_NADM_W_UNT,
label = id)) +
geom_label(nudge_y = 2) +
geom_point(size = 5) +
xlab('modern contraception use') +
ylab('desires for no more children')+
scale_colour_gradientn(colours = brewer.pal(9, 'RdPu'),
limits = c(15, 50)) +
# facet_wrap(~country) +
theme_xygrid()
ggplot(df, aes(x = FP_CUSM_W_MOD, y = PR_DESL_W_WNM,
colour = FP_NADM_W_UNT,
label = id)) +
geom_label(nudge_y = 2) +
geom_point(size = 5) +
xlab('modern contraception use') +
ylab('desires for no more children')+
scale_colour_gradientn(colours = brewer.pal(9, 'RdPu'),
limits = c(15, 50)) +
facet_wrap(~country) +
theme_xygrid()
ggplot(df, aes(x = FP_CUSM_W_MOD, y = PR_DESL_W_WNM,
colour = FP_NADM_W_UNT,
label = id)) +
geom_label(nudge_y = 2) +
geom_point(size = 5) +
xlab('modern contraception use') +
ylab('desires for no more children')+
scale_colour_gradientn(colours = brewer.pal(9, 'RdPu'),
limits = c(15, 50)) +
facet_wrap(~CountryName) +
theme_xygrid()
df = subnatl %>%
filter(CountryName %in% c('Benin', 'Ghana'),
IndicatorId %in% c('FP_NADM_W_UNT', 'PR_DESL_W_WNM',
'FP_CUSM_W_MOD', 'FP_CUSA_W_MOD'),
SurveyYear > 2010,
ByVariableLabel == 'Total' | ByVariableLabel == "") %>%
mutate(id = paste0(DHS_CountryCode,CharacteristicId)) %>%
select(id, CharacteristicLabel, CountryName, IndicatorId, Value, SurveyYear) %>%
spread(IndicatorId, Value)
ggplot(df, aes(x = FP_CUSM_W_MOD, y = 100 - PR_DESL_W_WNM,
colour = FP_NADM_W_UNT,
label = id)) +
geom_label(nudge_y = 2) +
geom_point(size = 5) +
xlab('modern contraception use') +
ylab('desires for no more children')+
scale_colour_gradientn(colours = brewer.pal(9, 'RdPu'),
limits = c(15, 50)) +
facet_wrap(~CountryName) +
theme_xygrid()
ggplot(df, aes(x = FP_CUSM_W_MOD, y = 100 - PR_DESL_W_WNM,
colour = FP_NADM_W_UNT,
label = CharacteristicLabel)) +
geom_label(nudge_y = 2) +
geom_point(size = 5) +
xlab('modern contraception use') +
ylab('desires for more children')+
scale_colour_gradientn(colours = brewer.pal(9, 'RdPu'),
limits = c(15, 50)) +
facet_wrap(~CountryName) +
theme_xygrid()
df = subnatl %>%
filter(CountryName %in% c('Benin', 'Ghana'),
IndicatorId %in% c('FP_NADM_W_UNT', 'PR_DESL_W_WNM',
'FP_CUSM_W_MOD', 'FP_CUSA_W_MOD'),
SurveyYear > 2010,
ByVariableLabel == 'Total' | ByVariableLabel == "") %>%
mutate(id = paste0(DHS_CountryCode,CharacteristicId)) %>%
select(id, CharacteristicLabel, CharacteristicCategory, CountryName, IndicatorId, Value, SurveyYear) %>%
spread(IndicatorId, Value)
ggplot(df, aes(x = FP_CUSM_W_MOD, y = 100 - PR_DESL_W_WNM,
colour = FP_NADM_W_UNT,
label = CharacteristicLabel)) +
geom_label(nudge_y = 2) +
geom_point(size = 5) +
xlab('modern contraception use') +
ylab('desires for more children')+
scale_colour_gradientn(colours = brewer.pal(9, 'RdPu'),
limits = c(15, 50)) +
facet_wrap(~CountryName + CharacteristicCategory) +
theme_xygrid()
ggplot(df, aes(x = FP_CUSM_W_MOD, y = 100 - PR_DESL_W_WNM,
colour = FP_NADM_W_UNT,
label = CharacteristicLabel)) +
geom_label(nudge_y = 2) +
geom_point(size = 5) +
xlab('modern contraception use') +
ylab('desires for more children')+
scale_colour_gradientn(colours = brewer.pal(9, 'RdPu'),
limits = c(15, 50)) +
facet_wrap(~CountryName + CharacteristicCategory)
ggplot(df %>% filter(!is.na(FP_NADM_W_UNT)), aes(x = FP_CUSM_W_MOD, y = 100 - PR_DESL_W_WNM,
colour = FP_NADM_W_UNT,
label = CharacteristicLabel)) +
geom_label(nudge_y = 2) +
geom_point(size = 5) +
xlab('modern contraception use') +
ylab('desires for more children')+
scale_colour_gradientn(colours = brewer.pal(9, 'RdPu'),
limits = c(15, 50)) +
facet_wrap(~CountryName + CharacteristicCategory)
ggplot(df %>% filter(!is.na(FP_NADM_W_UNT),
!is.na(FP_CUSM_W_MOD),
!is.na(PR_DESL_W_WNM)
), aes(x = FP_CUSM_W_MOD, y = 100 - PR_DESL_W_WNM,
colour = FP_NADM_W_UNT,
label = CharacteristicLabel)) +
geom_label(nudge_y = 2) +
geom_point(size = 5) +
xlab('modern contraception use') +
ylab('desires for more children')+
scale_colour_gradientn(colours = brewer.pal(9, 'RdPu'),
limits = c(15, 50)) +
facet_wrap(~CountryName + CharacteristicCategory)
df = subnatl %>%
filter(
IndicatorId %in% c('FP_NADM_W_UNT', 'PR_DESL_W_WNM',
'FP_CUSM_W_MOD', 'FP_CUSA_W_MOD'),
SurveyYear > 2010,
ByVariableLabel == 'Total' | ByVariableLabel == "") %>%
mutate(id = paste0(DHS_CountryCode,CharacteristicId)) %>%
select(id, CharacteristicLabel, CharacteristicCategory, CountryName, IndicatorId, Value, SurveyYear) %>%
spread(IndicatorId, Value)
ggplot(df %>% filter(!is.na(FP_NADM_W_UNT),
!is.na(FP_CUSM_W_MOD),
!is.na(PR_DESL_W_WNM)
), aes(x = FP_CUSM_W_MOD, y = 100 - PR_DESL_W_WNM,
colour = FP_NADM_W_UNT,
label = CharacteristicLabel)) +
geom_label(nudge_y = 2) +
geom_point(size = 5) +
xlab('modern contraception use') +
ylab('desires for more children')+
scale_colour_gradientn(colours = brewer.pal(9, 'RdPu'),
limits = c(15, 50)) +
facet_wrap(~CountryName + CharacteristicCategory)
df = subnatl %>%
filter(CountryName %in% c('Cameroon', "Cote d'Ivoire"),
IndicatorId %in% c('FP_NADM_W_UNT', 'PR_DESL_W_WNM',
'FP_CUSM_W_MOD', 'FP_CUSA_W_MOD'),
SurveyYear > 2010,
ByVariableLabel == 'Total' | ByVariableLabel == "") %>%
mutate(id = paste0(DHS_CountryCode,CharacteristicId)) %>%
select(id, CharacteristicLabel, CharacteristicCategory, CountryName, IndicatorId, Value, SurveyYear) %>%
spread(IndicatorId, Value)
ggplot(df %>% filter(!is.na(FP_NADM_W_UNT),
!is.na(FP_CUSM_W_MOD),
!is.na(PR_DESL_W_WNM)
), aes(x = FP_CUSM_W_MOD, y = 100 - PR_DESL_W_WNM,
colour = FP_NADM_W_UNT,
label = CharacteristicLabel)) +
geom_label(nudge_y = 2) +
geom_point(size = 5) +
xlab('modern contraception use') +
ylab('desires for more children')+
scale_colour_gradientn(colours = brewer.pal(9, 'RdPu'),
limits = c(15, 50)) +
facet_wrap(~CountryName + CharacteristicCategory)
ggplot(df %>% filter(!is.na(FP_NADM_W_UNT),
!is.na(FP_CUSM_W_MOD),
!is.na(PR_DESL_W_WNM)
), aes(x = FP_CUSM_W_MOD, y = 100 - PR_DESL_W_WNM,
colour = FP_NADM_W_UNT,
label = CharacteristicLabel)) +
geom_label(nudge_y = 2) +
geom_point(size = 5) +
xlab('modern contraception use') +
ylab('desires for more children')+
scale_colour_gradientn(colours = brewer.pal(9, 'RdPu'),
limits = c(15, 60)) +
facet_wrap(~CountryName + CharacteristicCategory)
ggplot(df %>% filter(!is.na(FP_NADM_W_UNT),
!is.na(FP_CUSM_W_MOD),
!is.na(PR_DESL_W_WNM)
), aes(x = FP_CUSM_W_MOD, y = 100 - PR_DESL_W_WNM,
colour = FP_NADM_W_UNT,
label = CharacteristicLabel)) +
geom_label(nudge_y = 2) +
geom_point(size = 5) +
xlab('modern contraception use') +
ylab('desires for more children')+
scale_colour_gradientn(colours = brewer.pal(9, 'RdPu'),
limits = c(10, 50)) +
facet_wrap(~CountryName + CharacteristicCategory)
df = subnatl %>%
filter(CountryName %in% c('Guinea', "Liberia"),
IndicatorId %in% c('FP_NADM_W_UNT', 'PR_DESL_W_WNM',
'FP_CUSM_W_MOD', 'FP_CUSA_W_MOD'),
SurveyYear > 2010,
ByVariableLabel == 'Total' | ByVariableLabel == "") %>%
mutate(id = paste0(DHS_CountryCode,CharacteristicId)) %>%
select(id, CharacteristicLabel, CharacteristicCategory, CountryName, IndicatorId, Value, SurveyYear) %>%
spread(IndicatorId, Value)
ggplot(df %>% filter(!is.na(FP_NADM_W_UNT),
!is.na(FP_CUSM_W_MOD),
!is.na(PR_DESL_W_WNM)
), aes(x = FP_CUSM_W_MOD, y = 100 - PR_DESL_W_WNM,
colour = FP_NADM_W_UNT,
label = CharacteristicLabel)) +
geom_label(nudge_y = 2) +
geom_point(size = 5) +
xlab('modern contraception use') +
ylab('desires for more children')+
scale_colour_gradientn(colours = brewer.pal(9, 'RdPu'),
limits = c(10, 50)) +
facet_wrap(~CountryName + CharacteristicCategory)
df = subnatl %>%
filter(CountryName %in% c('Mali', "Sierra Leone"),
IndicatorId %in% c('FP_NADM_W_UNT', 'PR_DESL_W_WNM',
'FP_CUSM_W_MOD', 'FP_CUSA_W_MOD'),
SurveyYear > 2010,
ByVariableLabel == 'Total' | ByVariableLabel == "") %>%
mutate(id = paste0(DHS_CountryCode,CharacteristicId)) %>%
select(id, CharacteristicLabel, CharacteristicCategory, CountryName, IndicatorId, Value, SurveyYear) %>%
spread(IndicatorId, Value)
ggplot(df %>% filter(!is.na(FP_NADM_W_UNT),
!is.na(FP_CUSM_W_MOD),
!is.na(PR_DESL_W_WNM)
), aes(x = FP_CUSM_W_MOD, y = 100 - PR_DESL_W_WNM,
colour = FP_NADM_W_UNT,
label = CharacteristicLabel)) +
geom_label(nudge_y = 2) +
geom_point(size = 5) +
xlab('modern contraception use') +
ylab('desires for more children')+
scale_colour_gradientn(colours = brewer.pal(9, 'RdPu'),
limits = c(10, 50)) +
facet_wrap(~CountryName + CharacteristicCategory)
df = subnatl %>%
filter(CountryName %in% c('Niger', "Nigeria"),
IndicatorId %in% c('FP_NADM_W_UNT', 'PR_DESL_W_WNM',
'FP_CUSM_W_MOD', 'FP_CUSA_W_MOD'),
SurveyYear > 2010,
ByVariableLabel == 'Total' | ByVariableLabel == "") %>%
mutate(id = paste0(DHS_CountryCode,CharacteristicId)) %>%
select(id, CharacteristicLabel, CharacteristicCategory, CountryName, IndicatorId, Value, SurveyYear) %>%
spread(IndicatorId, Value)
ggplot(df %>% filter(!is.na(FP_NADM_W_UNT),
!is.na(FP_CUSM_W_MOD),
!is.na(PR_DESL_W_WNM)
), aes(x = FP_CUSM_W_MOD, y = 100 - PR_DESL_W_WNM,
colour = FP_NADM_W_UNT,
label = CharacteristicLabel)) +
geom_label(nudge_y = 2) +
geom_point(size = 5) +
xlab('modern contraception use') +
ylab('desires for more children')+
scale_colour_gradientn(colours = brewer.pal(9, 'RdPu'),
limits = c(10, 50)) +
facet_wrap(~CountryName + CharacteristicCategory)
ggplot(df %>% filter(!is.na(FP_NADM_W_UNT),
!is.na(FP_CUSM_W_MOD),
!is.na(PR_DESL_W_WNM)
), aes(x = FP_CUSM_W_MOD, y = 100 - PR_DESL_W_WNM,
colour = FP_NADM_W_UNT,
label = CharacteristicLabel)) +
geom_label(nudge_y = 2) +
geom_point(size = 5) +
xlab('modern contraception use') +
ylab('desires for more children')+
scale_colour_gradientn(colours = brewer.pal(9, 'RdPu'),
limits = c(5, 20)) +
facet_wrap(~CountryName + CharacteristicCategory)
df = subnatl %>%
filter(CountryName %in% c('Benin', "Ghana"),
IndicatorId %in% c('FP_NADM_W_UNT', 'PR_DESL_W_WNM',
'FP_CUSM_W_MOD', 'FP_CUSA_W_MOD'),
SurveyYear > 2010,
ByVariableLabel == 'Total' | ByVariableLabel == "") %>%
mutate(id = paste0(DHS_CountryCode,CharacteristicId)) %>%
select(id, CharacteristicLabel, CharacteristicCategory, CountryName, IndicatorId, Value, SurveyYear) %>%
spread(IndicatorId, Value)
ggplot(df %>% filter(!is.na(FP_NADM_W_UNT),
!is.na(FP_CUSM_W_MOD),
!is.na(PR_DESL_W_WNM)
), aes(x = FP_CUSM_W_MOD, y = 100 - PR_DESL_W_WNM,
colour = FP_NADM_W_UNT,
label = CharacteristicLabel)) +
geom_label(nudge_y = 2) +
geom_point(size = 5) +
xlab('modern contraception use') +
ylab('desires for more children')+
scale_colour_gradientn(colours = brewer.pal(9, 'RdPu'),
limits = c(10, 50)) +
facet_wrap(~CountryName + CharacteristicCategory)
