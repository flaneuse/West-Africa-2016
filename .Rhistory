# geom_hline(yintercept = wAfrAvg, colour = grey80K, size = 0.5) +
geom_point(size = 3) +
geom_line() +
scale_colour_gradientn(colours = (brewer.pal(11, 'RdYlBu'))) +
facet_wrap(~CountryName) +
scale_y_continuous(limits = c(0, 25), breaks = c(0, 10, 20)) +
theme_xygrid() +
geom_text(aes(label = paste(round(Value,0),'%')), size = 3.5,
nudge_y = -7, colour = grey90K, check_overlap = TRUE) +
theme(rect = element_rect(fill = grey15K, colour = grey15K, linetype = 1, size =0),
panel.background = element_rect(fill= grey15K)) +
ylab('')+
ggtitle('Modern contraception use in all women is low but increasing') +
theme(title = element_text(size = 14),
rect = element_rect(fill = grey10K, colour = grey10K, linetype = 1, size =0),
panel.background = element_rect(fill= grey10K),
panel.margin = unit(1, 'lines'))
ggplot(df,
aes(x = SurveyYear, y = Value,
group = CountryName,
colour = deviation)) +
# geom_hline(yintercept = wAfrAvg, colour = grey80K, size = 0.5) +
geom_point(size = 3) +
geom_line() +
scale_colour_gradientn(colours = (brewer.pal(11, 'RdYlBu'))) +
facet_wrap(~CountryName) +
scale_y_continuous(limits = c(0, 25), breaks = c(0, 10, 20)) +
theme_xygrid() +
geom_text(aes(label = paste(round(Value,0),'%')), size = 3.5,
nudge_y = -4, colour = grey90K, check_overlap = TRUE) +
theme(rect = element_rect(fill = grey15K, colour = grey15K, linetype = 1, size =0),
panel.background = element_rect(fill= grey15K)) +
ylab('')+
ggtitle('Modern contraception use in all women is low but increasing') +
theme(title = element_text(size = 14),
rect = element_rect(fill = grey10K, colour = grey10K, linetype = 1, size =0),
panel.background = element_rect(fill= grey10K),
panel.margin = unit(1, 'lines'))
ggplot(df,
aes(y = CountryName, x = Value,
group = CountryName,
colour = SurveyYear)) +
geom_vline(xintercept = wAfrAvg, colour = grey80K, size = 0.5) +
geom_point(size = 3) +
geom_line() +
scale_colour_gradientn(colours = rev(brewer.pal(11, 'RdYlBu'))) +
theme_xgrid() +
scale_x_continuous(limits = c(0, 40)) +
theme(rect = element_rect(fill = grey15K, colour = grey15K, linetype = 1, size =0),
panel.background = element_rect(fill= grey10K))
df = natl %>% filter(Indicator %like% 'want no more',
ByVariableLabel == 'Total')
mostRecent = df %>%
group_by(CountryName) %>%
summarise(SurveyYear = max(SurveyYear))
avg = left_join(mostRecent, df)
wAfrAvg = mean(avg$Value)
avg = avg %>%
mutate(deviation = Value - wAfrAvg)
df = left_join(df, avg %>% select(CountryName, deviation))
order = df %>%
arrange(desc(deviation)) %>%
select(CountryName)
order = unique(order$CountryName)
df$CountryName = factor(df$CountryName, levels = order)
ggplot(df,
aes(x = SurveyYear, y = Value,
group = Indicator,
colour = deviation)) +
geom_hline(yintercept = wAfrAvg, colour = grey80K, size = 0.5) +
geom_point(size = 3) +
geom_line() +
scale_colour_gradientn(colours = (brewer.pal(11, 'RdYlBu'))) +
# geom_text(aes(label = IndicatorId)) +
facet_wrap(~CountryName) +
scale_y_continuous(limits = c(0, 70)) +
theme_xygrid() +
theme(rect = element_rect(fill = grey15K, colour = grey15K, linetype = 1, size =0),
panel.background = element_rect(fill= grey15K))
df = natl %>% filter(Indicator %like% 'want no more')
mostRecent = df %>%
group_by(CountryName) %>%
summarise(SurveyYear = max(SurveyYear))
avg = left_join(mostRecent, df)
wAfrAvg = mean(avg$Value)
avg = avg %>%
mutate(deviation = Value - wAfrAvg)
df = left_join(df, avg %>% select(CountryName, deviation))
order = df %>%
arrange(desc(deviation)) %>%
select(CountryName)
order = unique(order$CountryName)
df$CountryName = factor(df$CountryName, levels = order)
ggplot(df,
aes(x = SurveyYear, y = Value,
group = ByVariableLabel,
colour = ByVariableLabel)) +
geom_hline(yintercept = wAfrAvg, colour = grey80K, size = 0.5) +
geom_point(size = 3) +
geom_line() +
# scale_colour_gradientn(colours = (brewer.pal(11, 'RdYlBu'))) +
# geom_text(aes(label = IndicatorId)) +
facet_wrap(~CountryName + Indicator, scales = 'free_y')
theme_xygrid() +
theme(rect = element_rect(fill = grey15K, colour = grey15K, linetype = 1, size =0),
panel.background = element_rect(fill= grey15K))
#
df = natl %>% filter(Indicator %like% 'want no more')
mostRecent = df %>%
group_by(CountryName) %>%
summarise(SurveyYear = max(SurveyYear))
avg = left_join(mostRecent, df)
order = df %>%
arrange(desc(deviation)) %>%
select(CountryName)
order = unique(order$CountryName)
df$CountryName = factor(df$CountryName, levels = order)
ggplot(df,
aes(x = SurveyYear, y = Value,
group = ByVariableLabel,
colour = ByVariableLabel,
shape = IndicatorId)) +
geom_point(size = 3) +
geom_line() +
facet_wrap(~CountryName, scales = 'free_y') +
theme_xygrid() +
theme(rect = element_rect(fill = grey15K, colour = grey15K, linetype = 1, size =0),
panel.background = element_rect(fill= grey15K))
df2 = df %>%
select(Value, CountryName, SurveyYear, IndicatorId, ByVariableLabel) %>%
spread(IndicatorId, Value) %>%
mutate(diffVal = - PR_DESL_M_WNM + PR_DESL_W_WNM)
order = df2 %>%
filter(ByVariableLabel=='Total') %>%
arrange(desc(PR_DESL_W_WNM)) %>%
select(CountryName)
order = unique(order$CountryName)
df2$CountryName = factor(df2$CountryName, levels = order)
ggplot(df2,
aes(x = SurveyYear, y = diffVal,
group = ByVariableLabel,
colour = ByVariableLabel)) +
geom_point(size = 3) +
geom_line() +
facet_wrap(~CountryName) +
theme_basic() +
theme(rect = element_rect(fill = grey15K, colour = grey15K, linetype = 1, size =0),
panel.background = element_rect(fill= grey15K))
ggplot(df2 %>% filter(ByVariableLabel != 'Total'),
aes(x = 100 - PR_DESL_M_WNM, y = diffVal,
group = ByVariableLabel,
colour = ByVariableLabel)) +
geom_point(size = 3) +
facet_wrap(~CountryName) +
theme_basic() +
theme(rect = element_rect(fill = grey15K, colour = grey15K, linetype = 1, size =0),
panel.background = element_rect(fill= grey15K))
ggplot(df2 %>% filter(ByVariableLabel != 'Total'),
aes(x = 100 - PR_DESL_M_WNM, y = 100 - PR_DESL_W_WNM,
group = ByVariableLabel,
colour = ByVariableLabel)) +
geom_abline(slope = 1, intercept = 0,
colour = grey40K, size = 0.5) +
geom_point(size = 3) +
facet_wrap(~CountryName) +
coord_cartesian(xlim = c(0, 100), ylim = c(0, 100))+
theme_xygrid()
ggplot(df2 %>% filter(CountryName == 'Ghana',
ByVariableLabel != 'Total'),
aes(x = PR_DESL_M_WNM, y = diffVal,
group = ByVariableLabel,
colour = ByVariableLabel)) +
geom_point(size = 3) +
facet_wrap(~SurveyYear) +
theme_xygrid() +
theme(rect = element_rect(fill = grey15K, colour = grey15K, linetype = 1, size =0),
panel.background = element_rect(fill= grey15K))
df = natl %>%
filter(IndicatorId %in% c('FP_NADM_W_UNT', 'PR_DESL_W_WNM',
'FP_CUSA_W_MOD'),
SurveyYear > 2010,
ByVariableLabel == 'Total' | ByVariableLabel == "") %>%
select(CountryName, IndicatorId, Value, SurveyYear) %>%
spread(IndicatorId, Value)
ggplot(df, aes(x = FP_CUSA_W_MOD, y = PR_DESL_W_WNM,
colour = FP_NADM_W_UNT,
label = CountryName)) +
geom_label(nudge_y = 2) +
geom_point(size = 5) +
xlab('modern contraception use') +
ylab('desires for no more children')+
scale_colour_gradientn(colours = brewer.pal(9, 'RdPu'),
limits = c(15, 35)) +
theme_xygrid()
ggplot(df, aes(x = FP_CUSA_W_MOD, y = PR_DESL_W_WNM,
colour = FP_NADM_W_UNT,
label = CountryName)) +
geom_label(nudge_y = 2) +
geom_point(size = 5) +
xlab('modern contraception use') +
ylab('desires for no more children')+
scale_colour_gradientn(colours = brewer.pal(8, 'RdPu'),
limits = c(15, 35)) +
theme_xygrid()
ggplot(df, aes(x = FP_CUSA_W_MOD, y = PR_DESL_W_WNM,
colour = FP_NADM_W_UNT,
label = CountryName)) +
geom_label(nudge_y = 2) +
geom_point(size = 5) +
xlab('modern contraception use') +
ylab('desires for no more children')+
scale_colour_gradientn(colours = brewer.pal(9, 'RdPu'),
limits = c(10, 35)) +
theme_xygrid()
ggplot(df, aes(x = FP_CUSA_W_MOD, y = PR_DESL_W_WNM,
colour = FP_NADM_W_UNT,
size = FP_NADM_W_UNT,
label = CountryName)) +
geom_label(nudge_y = 2) +
geom_point(size = 5) +
xlab('modern contraception use') +
ylab('desires for no more children')+
scale_colour_gradientn(colours = brewer.pal(9, 'RdPu'),
limits = c(10, 35)) +
theme_xygrid()
ggplot(df, aes(x = FP_CUSA_W_MOD, y = PR_DESL_W_WNM,
colour = FP_NADM_W_UNT,
size = FP_NADM_W_UNT,
label = CountryName)) +
geom_label(nudge_y = 2, size = 5) +
geom_point() +
xlab('modern contraception use') +
ylab('desires for no more children')+
scale_colour_gradientn(colours = brewer.pal(9, 'RdPu'),
limits = c(10, 35)) +
theme_xygrid()
ggplot(df, aes(x = FP_CUSA_W_MOD, y = 100- PR_DESL_W_WNM,
colour = FP_NADM_W_UNT,
size = FP_NADM_W_UNT,
label = CountryName)) +
geom_label(nudge_y = 2, size = 5) +
geom_point() +
xlab('modern contraception use') +
ylab('desires for no more children')+
scale_colour_gradientn(colours = brewer.pal(9, 'RdPu'),
limits = c(10, 35)) +
theme_xygrid()
View(natl)
ggplot(df, aes(x = FP_CUSA_W_MOD, y = 100- PR_DESL_W_WNM,
colour = FP_NADM_W_UNT,
size = FP_NADM_W_UNT,
label = CountryName)) +
geom_label(nudge_y = 2, size = 5) +
geom_point() +
xlab('modern contraception use in all women') +
ggtitle('')+
ylab('percent of women desiring more children')+
scale_colour_gradientn(colours = brewer.pal(9, 'RdPu'),
limits = c(10, 35)) +
theme_xygrid()
ggplot(df, aes(x = FP_CUSA_W_MOD, y = 100- PR_DESL_W_WNM,
colour = FP_NADM_W_UNT,
size = FP_NADM_W_UNT,
label = CountryName)) +
geom_label(nudge_y = 2, size = 5) +
geom_point() +
xlab('modern contraception use in all women') +
ggtitle('')+
coord_cartesian(xlim = c(0, 25), ylim = c(0, 100))+
ylab('percent of women desiring more children')+
scale_colour_gradientn(colours = brewer.pal(9, 'RdPu'),
limits = c(7, 35)) +
theme_xygrid()
ggplot(df, aes(x = FP_CUSA_W_MOD, y = 100- PR_DESL_W_WNM,
colour = FP_NADM_W_UNT,
size = FP_NADM_W_UNT,
label = CountryName)) +
geom_label(nudge_y = 2, size = 5) +
geom_point() +
xlab('modern contraception use in all women') +
ggtitle('')+
coord_cartesian(xlim = c(0, 25), ylim = c(0, 100))+
ylab('percent of women desiring more children')+
scale_colour_gradientn(colours = brewer.pal(9, 'RdPu'),
limits = c(7, 35)) +
theme_xygrid() +
theme(legend.position = c(0.1, 0.1))
df
ggplot(df, aes(x = FP_CUSA_W_MOD, y = 100- PR_DESL_W_WNM,
colour = FP_NADM_W_UNT,
size = FP_NADM_W_UNT,
label = SurveyYear)) +
geom_label(nudge_y = 2, size = 5) +
geom_point() +
xlab('modern contraception use in all women') +
ggtitle('')+
# coord_cartesian(xlim = c(0, 25), ylim = c(0, 100))+
ylab('percent of women desiring more children')+
scale_colour_gradientn(colours = brewer.pal(9, 'RdPu'),
limits = c(7, 35)) +
theme_xygrid() +
theme(legend.position = c(0.1, 0.1))
ggplot(df, aes(x = FP_CUSA_W_MOD, y = 100- PR_DESL_W_WNM,
colour = FP_NADM_W_UNT,
size = FP_NADM_W_UNT,
label = CountryName)) +
geom_label(nudge_y = 2, size = 5) +
geom_point() +
xlab('modern contraception use in all women') +
ggtitle('')+
# coord_cartesian(xlim = c(0, 25), ylim = c(0, 100))+
ylab('percent of women desiring more children')+
scale_colour_gradientn(colours = brewer.pal(9, 'RdPu'),
limits = c(7, 35)) +
theme_xygrid() +
theme(legend.position = c(0.1, 0.1))
df = subnatl %>%
filter(CountryName %in% c('Cameroon', "Cote d'Ivoire"),
IndicatorId %in% c('FP_NADM_W_UNT', 'PR_DESL_W_WNM',
'FP_CUSM_W_MOD', 'FP_CUSA_W_MOD'),
SurveyYear > 2010,
ByVariableLabel == 'Total' | ByVariableLabel == "") %>%
mutate(id = paste0(DHS_CountryCode,CharacteristicId)) %>%
select(id, CharacteristicLabel, CharacteristicCategory, CountryName, IndicatorId, Value, SurveyYear) %>%
spread(IndicatorId, Value)
#!!
ggplot(df2 %>% filter(ByVariableLabel != 'Total'),
aes(x = 100 - PR_DESL_M_WNM, y = 100 - PR_DESL_W_WNM,
group = ByVariableLabel,
colour = ByVariableLabel)) +
geom_abline(slope = 1, intercept = 0,
colour = grey40K, size = 0.5) +
geom_point(size = 3) +
facet_wrap(~CountryName) +
coord_cartesian(xlim = c(0, 100), ylim = c(0, 100))+
theme_xygrid()
ggplot(df2 %>% filter(ByVariableLabel != 'Total'),
aes(x = 100 - PR_DESL_M_WNM, y = 100 - PR_DESL_W_WNM,
group = ByVariableLabel,
colour = ByVariableLabel)) +
geom_abline(slope = 1, intercept = 0,
colour = grey40K, size = 0.5) +
geom_point(size = 3) +
facet_wrap(~CountryName) +
coord_cartesian(xlim = c(0, 100), ylim = c(0, 100))+
theme_xygrid() +
theme(legend.position = c(0.8, 0.1),
panel.margin = unit(1, 'lines'))
ggplot(df2 %>% filter(ByVariableLabel != 'Total'),
aes(x = 100 - PR_DESL_M_WNM, y = 100 - PR_DESL_W_WNM,
group = ByVariableLabel,
colour = ByVariableLabel)) +
geom_abline(slope = 1, intercept = 0,
colour = grey40K, size = 0.5) +
geom_point(size = 3) +
facet_wrap(~CountryName) +
coord_cartesian(xlim = c(0, 100), ylim = c(0, 100))+
theme_xygrid() +
ggtitle('Men and women have different desires for more children') +
xlab('percent of men wanting more children') +
ylab('percent of women wanting more children') +
theme(legend.position = c(0.8, 0.1),
legend.direction = 'horizontal',
panel.margin = unit(1, 'lines'))
svyYrs = allData %>%
group_by(SurveyYear, CountryName) %>%
summarise(num  = n()) %>%
mutate(year = as.integer(SurveyYear))
ggplot(svyYrs, aes(x = year, y = CountryName, size = num)) +
geom_point() +
scale_x_continuous(breaks = seq(1986, 2016, by = 4)) +
theme_xgrid()
ggplot(svyYrs, aes(x = year, y = CountryName, size = num)) +
geom_point() +
scale_x_continuous(limits = c(2000, 2016),
breaks = seq(2000, 2016, by = 2)) +
theme_xgrid()
json_file <- fromJSON(paste0('http://api.dhsprogram.com/rest/dhs/data?breakdown=national&indicatorIds=',indicators,
'&countryIds=', countries,
'&SurveyYear=', years,
'&apiKey=', apiKey,
'&perpage=5000'))
# Unlist the JSON file entries
json_data <- lapply(json_file$Data, function(x) { unlist(x) })
# Convert JSON input to a data frame
allData <- as.data.frame(do.call("rbind", json_data),stringsAsFactors=FALSE)
svyYrs = allData %>%
group_by(SurveyYear, CountryName) %>%
summarise(num  = n()) %>%
mutate(year = as.integer(SurveyYear))
ggplot(svyYrs, aes(x = year, y = CountryName, size = num)) +
geom_point() +
scale_x_continuous(limits = c(2000, 2016),
breaks = seq(2000, 2016, by = 2)) +
theme_xgrid()
allData %>%
group_by(SurveyYear, CountryName, SurveyType) %>%
summarise(num  = n()) %>%
mutate(year = as.integer(SurveyYear))
svyYrs = allData %>%
group_by(SurveyYear, CountryName, SurveyType) %>%
summarise(num  = n()) %>%
mutate(year = as.integer(SurveyYear))
ggplot(svyYrs, aes(x = year,
y = CountryName,
label= year,
colour = SurveyType)) +
geom_text(size = 5)+
scale_x_continuous(limits = c(2000, 2016),
breaks = seq(2000, 2016, by = 2)) +
theme_xgrid()
ggplot(svyYrs, aes(x = year,
y = CountryName,
label= year,
colour = SurveyType)) +
geom_text(size = 5)+
scale_x_continuous(limits = c(2000, 2016),
breaks = seq(2000, 2016, by = 2)) +
theme_ygrid()
ggplot(svyYrs, aes(x = year,
y = CountryName,
label= year,
colour = SurveyType)) +
geom_label(size = 5)+
scale_x_continuous(limits = c(2000, 2016),
breaks = seq(2000, 2016, by = 2)) +
theme_ygrid() +
xlab('') + ylab('')
ggplot(svyYrs, aes(x = year,
y = CountryName,
label= year,
colour = SurveyType)) +
geom_label(size = 5)+
scale_x_continuous(limits = c(2000, 2016),
breaks = seq(2000, 2016, by = 2)) +
theme_ygrid() +
scale_y_reverse()+
xlab('') + ylab('')
ggplot(svyYrs, aes(x = year,
y = CountryName,
label= year,
colour = SurveyType)) +
geom_label(size = 5)+
scale_x_continuous(limits = c(2000, 2016),
breaks = seq(2000, 2016, by = 2)) +
theme_ygrid() +
# scale_y_reverse()+
xlab('') + ylab('')
svyYrs$CountryName = factor(svyYrs$CountryName,
levels = rev(svyYrs$CountryName))
ggplot(svyYrs, aes(x = year,
y = CountryName,
label= year,
colour = SurveyType)) +
geom_label(size = 5)+
scale_x_continuous(limits = c(2000, 2016),
breaks = seq(2000, 2016, by = 2)) +
theme_ygrid() +
# scale_y_reverse()+
xlab('') + ylab('')
ggplot(svyYrs, aes(x = year,
y = CountryName,
label= year,
colour = SurveyType)) +
geom_label(size = 5)+
scale_x_continuous(limits = c(2000, 2016),
breaks = seq(2000, 2016, by = 2)) +
theme_ygrid() +
# scale_y_reverse()+
xlab('') + ylab('') +
ggtitle('Available DHS data')
allData %>%
group_by(SurveyYear, CountryName, SurveyType) %>%
summarise(num  = n()) %>%
mutate(year = as.integer(SurveyYear))
View(svyYrs)
levels(svyYrs$CountryName)
svyYrs$CountryName = factor(svyYrs$CountryName,
levels = rev(sort(svyYrs$CountryName)))
ggplot(svyYrs, aes(x = year,
y = CountryName,
label= year,
colour = SurveyType)) +
geom_label(size = 5)+
scale_x_continuous(limits = c(2000, 2016),
breaks = seq(2000, 2016, by = 2)) +
theme_ygrid() +
# scale_y_reverse()+
xlab('') + ylab('') +
ggtitle('Available DHS data')
sort(svyYrs$CountryName)
unique(sort(svyYrs$CountryName))
svyYrs = allData %>%
group_by(SurveyYear, CountryName, SurveyType) %>%
summarise(num  = n()) %>%
mutate(year = as.integer(SurveyYear))
levels(svyYrs$CountryName)
sort(svyYrs$CountryName)
unique(sort(svyYrs$CountryName))
svyYrs$CountryName = factor(svyYrs$CountryName,
levels = rev(unique(sort(svyYrs$CountryName))))
ggplot(svyYrs, aes(x = year,
y = CountryName,
label= year,
colour = SurveyType)) +
geom_label(size = 5)+
scale_x_continuous(limits = c(2000, 2016),
breaks = seq(2000, 2016, by = 2)) +
theme_ygrid() +
# scale_y_reverse()+
xlab('') + ylab('') +
ggtitle('Available Demographic and Health Surveys data')
