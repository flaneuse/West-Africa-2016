scale_colour_gradientn(colours = brewer.pal(9, 'RdPu'),
name = 'unmet need',
limits = c(7, 35)) +
theme_xygrid() +
guides(colour = guide_colorbar(ticks = FALSE))+
theme(legend.position = c(0.9, 0.9))
# babies, tfr, colored by women -------------------------------------------
ggplot(df, aes(x = diffBabies, y = tfr,
colour = PR_DESL_W_WNM,
size = FP_NADM_W_UNT,
label = CountryName)) +
geom_label(nudge_y = 0.3, size = 3,
family = 'Segoe UI Semilight') +
geom_point() +
xlab('difference between male and female desires for more children') +
ggtitle('')+
ylab('total fertility rate')+
scale_size(name = 'unmet need') +
scale_colour_gradientn(colours = rev(brewer.pal(9, 'RdPu')),
name = 'W. baby wants',
limits = c(7, 40)) +
facet_wrap(~CountryName) +
theme_xygrid() +
guides(colour = guide_colorbar(ticks = FALSE))+
theme(legend.position = c(0.9, 0.9))
plot_tooltip = function(x) {
if(is.null(x)) return(NULL)
paste0(x$diffBabies, ';', x$tfr)
}
yLim = c(4, 8)
yVar = 'total fertility rate'
xVar = 'difference in baby desires'
widthPlot = 'auto'
heightPlot = 'auto'
df %>%
ggvis(x = ~diffBabies, y = ~tfr,
fill = ~PR_DESL_W_WNM) %>%
set_options(height = heightPlot, width = widthPlot) %>%
layer_points(size = ~PR_DESL_W_WNM,
stroke := grey60K, stroke.hover := 'red',
fill.hover := "red",
fillOpacity := 1, fillOpacity.hover := 0.5) %>%
layer_text(text := ~CountryName,
fontSize := 16,
fontWeight := 300,
align := 'center',
baseline:="top",
dy := 10,
font := 'Segoe UI') %>%
add_axis(type = 'y',
title = yVar,
tick_size_major = 0,
properties = axis_props(
axis = list(strokeWidth = 0),
title = list(fontSize = 18,
fill = grey70K,
fontWeight = 300,
font = 'Segoe UI'),
labels = list(fontSize = 16,
fill = grey60K,
fontWeight = 200,
font = 'Segoe UI'))) %>%
# grid = list(
# strokeWidth = 0)
# )) %>%
add_axis(type = 'x',
tick_size_major = 0,
title = xVar,
properties = axis_props(
axis = list(strokeWidth = 0),
title = list(fontSize = 18,
fill = grey70K,
fontWeight = 300,
font = 'Segoe UI'),
labels = list(fontSize = 16,
fill = grey60K,
fontWeight = 200,
font = 'Segoe UI'))) %>%
# grid = list(strokeWidth = 0))) %>%
scale_numeric("y", domain = yLim) %>%
add_tooltip(plot_tooltip, "hover")
ggplot(df, aes(x = FP_CUSM_W_MOD, y = tfr,
colour = FP_NADM_W_UNT,
size = FP_NADM_W_UNT,
label = CountryName)) +
geom_label(nudge_y = 0.3, size = 5,
family = 'Segoe UI Semilight') +
geom_point() +
xlab('modern contraception use in married women') +
ggtitle('')+
ylab('total fertility rate')+
scale_size(guide = 'none') +
scale_colour_gradientn(colours = brewer.pal(9, 'RdPu'),
name = 'unmet need',
limits = c(7, 35)) +
theme_xygrid() +
theme(panel.grid.major.x = element_line(size = 0.1),
panel.grid.major.y = element_line(size = 0.1))+
guides(colour = guide_colorbar(ticks = FALSE))+
theme(legend.position = c(0.9, 0.9))+
coord_cartesian(xlim = c(0, 25))
library(llamar)
loadPkgs()
natl = read.csv('~/Documents/USAID/West Africa Regional 2016/dataout/WAFR_DHS_natl.csv')
df = natl %>%
filter(IndicatorId %in% c('FP_NADM_W_UNT', 'PR_DESL_W_WNM',
'FP_CUSA_W_MOD', 'FP_CUSM_W_MOD',
'FE_FRTR_W_TFR',
'PR_DESL_M_WNM'),
SurveyYear >= 2010 | SurveyYear == 2000,
ByVariableLabel == 'Total' | ByVariableLabel == "") %>%
select(CountryName, IndicatorId, Value, SurveyYear) %>%
spread(IndicatorId, Value) %>%
filter(SurveyYear != 2012 | CountryName != 'Senegal',
SurveyYear != 2010 | CountryName != 'Senegal') %>%
mutate(diffBabies = - PR_DESL_M_WNM + PR_DESL_W_WNM,
tfr = FE_FRTR_W_TFR)
# Plot TFR ---------------------------------------------------------------
ggplot(df, aes(x = FP_CUSM_W_MOD, y = tfr,
colour = FP_NADM_W_UNT,
size = FP_NADM_W_UNT,
label = CountryName)) +
geom_label(nudge_y = 0.3, size = 5,
family = 'Segoe UI Semilight') +
geom_point() +
xlab('modern contraception use in married women') +
ggtitle('')+
ylab('total fertility rate')+
scale_size(guide = 'none') +
scale_colour_gradientn(colours = brewer.pal(9, 'RdPu'),
name = 'unmet need',
limits = c(7, 35)) +
theme_xygrid() +
theme(panel.grid.major.x = element_line(size = 0.1),
panel.grid.major.y = element_line(size = 0.1))+
guides(colour = guide_colorbar(ticks = FALSE))+
theme(legend.position = c(0.9, 0.9))+
coord_cartesian(xlim = c(0, 25))
df
df = natl %>%
filter(IndicatorId %in% c('FP_NADM_W_UNT',  'FP_CUSM_W_MOD',
'FE_FRTR_W_TFR'),
SurveyYear >= 2010 | SurveyYear == 2000,
ByVariableLabel == 'Total' | ByVariableLabel == "") %>%
select(CountryName, IndicatorId, Value, SurveyYear) %>%
spread(IndicatorId, Value) %>%
filter(SurveyYear != 2012 | CountryName != 'Senegal',
SurveyYear != 2010 | CountryName != 'Senegal') %>%
mutate(diffBabies = - PR_DESL_M_WNM + PR_DESL_W_WNM,
tfr = FE_FRTR_W_TFR)
natl = read.csv('~/Documents/USAID/West Africa Regional 2016/dataout/WAFR_DHS_natl.csv')
df = natl %>%
filter(IndicatorId %in% c('FP_NADM_W_UNT',  'FP_CUSM_W_MOD',
'FE_FRTR_W_TFR'),
SurveyYear >= 2010 | SurveyYear == 2000,
ByVariableLabel == 'Total' | ByVariableLabel == "") %>%
select(CountryName, IndicatorId, Value, SurveyYear) %>%
spread(IndicatorId, Value) %>%
filter(SurveyYear != 2012 | CountryName != 'Senegal',
SurveyYear != 2010 | CountryName != 'Senegal') %>%
mutate(diffBabies = - PR_DESL_M_WNM + PR_DESL_W_WNM,
tfr = FE_FRTR_W_TFR)
natl = read.csv('~/Documents/USAID/West Africa Regional 2016/dataout/WAFR_DHS_natl.csv')
df = natl %>%
filter(IndicatorId %in% c('FP_NADM_W_UNT', 'PR_DESL_W_WNM',
'FP_CUSA_W_MOD', 'FP_CUSM_W_MOD',
'FE_FRTR_W_TFR',
'PR_DESL_M_WNM'),
SurveyYear >= 2010 | SurveyYear == 2000,
ByVariableLabel == 'Total' | ByVariableLabel == "") %>%
select(CountryName, IndicatorId, Value, SurveyYear) %>%
spread(IndicatorId, Value) %>%
filter(SurveyYear != 2012 | CountryName != 'Senegal',
SurveyYear != 2010 | CountryName != 'Senegal') %>%
mutate(diffBabies = - PR_DESL_M_WNM + PR_DESL_W_WNM,
tfr = FE_FRTR_W_TFR)
df = natl %>%
filter(IndicatorId %in% c('FP_NADM_W_UNT', 'FP_CUSM_W_MOD',
'FE_FRTR_W_TFR'),
SurveyYear >= 2010 | SurveyYear == 2000,
ByVariableLabel == 'Total' | ByVariableLabel == "") %>%
select(CountryName, IndicatorId, Value, SurveyYear) %>%
spread(IndicatorId, Value) %>%
filter(SurveyYear != 2012 | CountryName != 'Senegal',
SurveyYear != 2010 | CountryName != 'Senegal') %>%
mutate(
tfr = FE_FRTR_W_TFR)
# Plot TFR ---------------------------------------------------------------
ggplot(df, aes(x = FP_CUSM_W_MOD, y = tfr,
colour = FP_NADM_W_UNT,
size = FP_NADM_W_UNT,
label = CountryName)) +
geom_label(nudge_y = 0.3, size = 5,
family = 'Segoe UI Semilight') +
geom_point() +
xlab('modern contraception use in married women') +
ggtitle('')+
ylab('total fertility rate')+
scale_size(guide = 'none') +
scale_colour_gradientn(colours = brewer.pal(9, 'RdPu'),
name = 'unmet need',
limits = c(7, 35)) +
theme_xygrid() +
theme(panel.grid.major.x = element_line(size = 0.1),
panel.grid.major.y = element_line(size = 0.1))+
guides(colour = guide_colorbar(ticks = FALSE))+
theme(legend.position = c(0.9, 0.9))+
coord_cartesian(xlim = c(0, 25))
df
df = natl %>%
filter(IndicatorId %in% c('FP_NADM_W_UNT', 'FP_CUSM_W_MOD',
'FE_FRTR_W_TFR'),
SurveyYear >= 2010 | SurveyYear == 2000,
ByVariableLabel == 'Total' | ByVariableLabel == "") %>%
select(CountryName, IndicatorId, Value, SurveyYear) %>%
spread(IndicatorId, Value) %>%
filter(SurveyYear != 2012 | CountryName != 'Senegal',
SurveyYear != 2010 | CountryName != 'Senegal') %>%
rename(contra = FP_CUSM_W_MOD,
unmet = FP_NADM_W_UNT,
tfr = FE_FRTR_W_TFR)
# Plot TFR ---------------------------------------------------------------
ggplot(df, aes(x = contra, y = tfr,
colour = unmet,
size = unmet,
label = CountryName)) +
geom_label(nudge_y = 0.3, size = 5,
family = 'Segoe UI Semilight') +
geom_point() +
xlab('modern contraception use in married women') +
ggtitle('')+
ylab('total fertility rate')+
scale_size(guide = 'none') +
scale_colour_gradientn(colours = brewer.pal(9, 'RdPu'),
name = 'unmet need',
limits = c(7, 35)) +
theme_xygrid() +
theme(panel.grid.major.x = element_line(size = 0.1),
panel.grid.major.y = element_line(size = 0.1))+
guides(colour = guide_colorbar(ticks = FALSE))+
theme(legend.position = c(0.9, 0.9))+
coord_cartesian(xlim = c(0, 25))
df
newData = data.frame(CountryName = c('Mauritania', 'Guinea-Bissau', 'Cape Verde'),
tfr = c(4.7, 4.9, 2.3),
contra =c(10, 10.3, 57.1),
unmet = c(31.1, 6, 16.7)
)
df = rbind(df, newData)
# Plot TFR ---------------------------------------------------------------
ggplot(df, aes(x = contra, y = tfr,
colour = unmet,
size = unmet,
label = CountryName)) +
geom_label(nudge_y = 0.3, size = 5,
family = 'Segoe UI Semilight') +
geom_point() +
xlab('modern contraception use in married women') +
ggtitle('')+
ylab('total fertility rate')+
scale_size(guide = 'none') +
scale_colour_gradientn(colours = brewer.pal(9, 'RdPu'),
name = 'unmet need',
limits = c(7, 35)) +
theme_xygrid() +
theme(panel.grid.major.x = element_line(size = 0.1),
panel.grid.major.y = element_line(size = 0.1))+
guides(colour = guide_colorbar(ticks = FALSE))+
theme(legend.position = c(0.9, 0.9))+
coord_cartesian(xlim = c(0, 25))
df = natl %>%
filter(IndicatorId %in% c('FP_NADM_W_UNT', 'FP_CUSM_W_MOD',
'FE_FRTR_W_TFR'),
SurveyYear >= 2010 | SurveyYear == 2000,
ByVariableLabel == 'Total' | ByVariableLabel == "") %>%
select(CountryName, IndicatorId, Value, SurveyYear) %>%
spread(IndicatorId, Value) %>%
filter(SurveyYear != 2012 | CountryName != 'Senegal',
SurveyYear != 2010 | CountryName != 'Senegal') %>%
rename(contra = FP_CUSM_W_MOD,
unmet = FP_NADM_W_UNT,
tfr = FE_FRTR_W_TFR) %>%
select(-SurveyYear)
newData = data.frame(CountryName = c('Mauritania', 'Guinea-Bissau', 'Cape Verde'),
tfr = c(4.7, 4.9, 2.3),
contra =c(10, 10.3, 57.1),
unmet = c(31.1, 6, 16.7)
)
df = rbind(df, newData)
# Plot TFR ---------------------------------------------------------------
ggplot(df, aes(x = contra, y = tfr,
colour = unmet,
size = unmet,
label = CountryName)) +
geom_label(nudge_y = 0.3, size = 5,
family = 'Segoe UI Semilight') +
geom_point() +
xlab('modern contraception use in married women') +
ggtitle('')+
ylab('total fertility rate')+
scale_size(guide = 'none') +
scale_colour_gradientn(colours = brewer.pal(9, 'RdPu'),
name = 'unmet need',
limits = c(7, 35)) +
theme_xygrid() +
theme(panel.grid.major.x = element_line(size = 0.1),
panel.grid.major.y = element_line(size = 0.1))+
guides(colour = guide_colorbar(ticks = FALSE))+
theme(legend.position = c(0.9, 0.9))+
coord_cartesian(xlim = c(0, 25))
ggplot(df, aes(x = contra, y = tfr,
colour = unmet,
size = unmet,
label = CountryName)) +
geom_label(nudge_y = 0.3, size = 5,
family = 'Segoe UI Semilight') +
geom_point() +
xlab('modern contraception use in married women') +
ggtitle('')+
ylab('total fertility rate')+
scale_size(guide = 'none') +
scale_colour_gradientn(colours = brewer.pal(9, 'RdPu'),
name = 'unmet need',
limits = c(6, 35)) +
scale_y_continuous(limits = c(4, 8),
breaks = c(4, 6,8)) +
theme_xygrid() +
theme(panel.grid.major.x = element_line(size = 0.1),
panel.grid.major.y = element_line(size = 0.1))+
guides(colour = guide_colorbar(ticks = FALSE))+
theme(legend.position = c(0.9, 0.9))+
coord_cartesian(xlim = c(0, 58))
ggplot(df, aes(x = contra, y = tfr,
colour = unmet,
size = unmet,
label = CountryName)) +
geom_label(nudge_y = 0.3, size = 5,
family = 'Segoe UI Semilight') +
geom_point() +
xlab('modern contraception use in married women') +
ggtitle('')+
ylab('total fertility rate')+
scale_size(guide = 'none') +
scale_colour_gradientn(colours = brewer.pal(9, 'RdPu'),
name = 'unmet need',
limits = c(6, 35)) +
scale_y_continuous(limits = c(4, 8),
breaks = c(4, 6,8)) +
theme_xygrid() +
theme(panel.grid.major.x = element_line(size = 0.1),
panel.grid.major.y = element_line(size = 0.1))+
guides(colour = guide_colorbar(ticks = FALSE))+
theme(legend.position = c(0.9, 0.9))+
coord_cartesian(xlim = c(0, 25))
ggplot(df, aes(x = contra, y = tfr,
colour = unmet,
size = unmet,
label = CountryName)) +
geom_label(nudge_y = 0.3, size = 5,
family = 'Segoe UI Semilight') +
geom_point() +
xlab('modern contraception use in married women') +
ggtitle('')+
ylab('total fertility rate')+
scale_size(guide = 'none') +
scale_colour_gradientn(colours = brewer.pal(9, 'RdPu'),
name = 'unmet need',
limits = c(4, 35)) +
scale_y_continuous(limits = c(4, 8),
breaks = c(4, 6,8)) +
theme_xygrid() +
theme(panel.grid.major.x = element_line(size = 0.1),
panel.grid.major.y = element_line(size = 0.1))+
guides(colour = guide_colorbar(ticks = FALSE))+
theme(legend.position = c(0.9, 0.9))+
coord_cartesian(xlim = c(0, 25))
df = natl %>%
filter(IndicatorId %in% c('FP_NADM_W_UNT', 'FP_CUSM_W_MOD',
'FE_FRTR_W_TFR'),
SurveyYear >= 2010 | SurveyYear == 2000,
ByVariableLabel == 'Total' | ByVariableLabel == "") %>%
select(CountryName, IndicatorId, Value, SurveyYear) %>%
spread(IndicatorId, Value) %>%
filter(SurveyYear != 2012 | CountryName != 'Senegal',
SurveyYear != 2010 | CountryName != 'Senegal',
CountryName != 'Mauritania') %>%
rename(contra = FP_CUSM_W_MOD,
unmet = FP_NADM_W_UNT,
tfr = FE_FRTR_W_TFR) %>%
select(-SurveyYear)
newData = data.frame(CountryName = c('Mauritania', 'Guinea-Bissau', 'Cape Verde'),
tfr = c(4.7, 4.9, 2.3),
contra =c(10, 10.3, 57.1),
unmet = c(31.1, 6, 16.7)
)
df = rbind(df, newData)
# Plot TFR ---------------------------------------------------------------
ggplot(df, aes(x = contra, y = tfr,
colour = unmet,
size = unmet,
label = CountryName)) +
geom_label(nudge_y = 0.3, size = 5,
family = 'Segoe UI Semilight') +
geom_point() +
xlab('modern contraception use in married women') +
ggtitle('')+
ylab('total fertility rate')+
scale_size(guide = 'none') +
scale_colour_gradientn(colours = brewer.pal(9, 'RdPu'),
name = 'unmet need',
limits = c(4, 35)) +
scale_y_continuous(limits = c(4, 8),
breaks = c(4, 6,8)) +
theme_xygrid() +
theme(panel.grid.major.x = element_line(size = 0.1),
panel.grid.major.y = element_line(size = 0.1))+
guides(colour = guide_colorbar(ticks = FALSE))+
theme(legend.position = c(0.9, 0.9))+
coord_cartesian(xlim = c(0, 25))
ggplot(df, aes(x = contra, y = tfr,
colour = unmet,
size = unmet,
label = CountryName)) +
geom_label(nudge_y = 0.3, size = 5,
family = 'Segoe UI Semilight') +
geom_point() +
xlab('modern contraception use in married women') +
ggtitle('')+
ylab('total fertility rate')+
scale_size(guide = 'none') +
scale_colour_gradientn(colours = brewer.pal(9, 'RdPu'),
name = 'unmet need',
limits = c(4, 35)) +
scale_y_continuous(limits = c(4, 8),
breaks = c(4, 6,8)) +
theme_xygrid() +
theme(panel.grid.major.x = element_line(size = 0.1),
panel.grid.major.y = element_line(size = 0.1))+
guides(colour = guide_colorbar(ticks = FALSE))+
theme(legend.position = c(0.9, 0.9))+
coord_cartesian(xlim = c(4, 24))
library(llamar)
loadPkgs()
natl = read.csv('~/Documents/USAID/West Africa Regional 2016/dataout/WAFR_DHS_natl.csv')
df = natl %>%
filter(IndicatorId %in% c('FP_NADM_W_UNT', 'FP_CUSM_W_MOD',
'FE_FRTR_W_TFR'),
SurveyYear >= 2010 | SurveyYear == 2000,
ByVariableLabel == 'Total' | ByVariableLabel == "") %>%
select(CountryName, IndicatorId, Value, SurveyYear) %>%
spread(IndicatorId, Value) %>%
filter(SurveyYear != 2012 | CountryName != 'Senegal',
SurveyYear != 2010 | CountryName != 'Senegal',
CountryName != 'Mauritania') %>%
rename(contra = FP_CUSM_W_MOD,
unmet = FP_NADM_W_UNT,
tfr = FE_FRTR_W_TFR) %>%
select(-SurveyYear)
newData = data.frame(CountryName = c('Mauritania', 'Guinea-Bissau', 'Cape Verde'),
tfr = c(4.7, 4.9, 2.3),
contra =c(10, 10.3, 57.1),
unmet = c(31.1, 6, 16.7)
)
df = rbind(df, newData)
# Plot TFR ---------------------------------------------------------------
ggplot(df, aes(x = contra, y = tfr,
colour = unmet,
size = unmet,
label = CountryName)) +
geom_label(nudge_y = 0.3, size = 5,
family = 'Segoe UI Semilight') +
geom_point() +
xlab('modern contraception use in married women') +
ggtitle('')+
ylab('total fertility rate')+
scale_size(guide = 'none') +
scale_colour_gradientn(colours = brewer.pal(9, 'RdPu'),
name = 'unmet need',
limits = c(4, 35)) +
scale_y_continuous(limits = c(4, 8),
breaks = c(4, 6,8)) +
theme_xygrid() +
theme(panel.grid.major.x = element_line(size = 0.1),
panel.grid.major.y = element_line(size = 0.1))+
guides(colour = guide_colorbar(ticks = FALSE))+
theme(legend.position = c(0.9, 0.9))+
coord_cartesian(xlim = c(4, 24))
ggsave(...)
ggsave("~/GitHub/West Africa 2016/plots/2016-04-11_healthEcon1_freescales.pdf",
width = 12, height = 4,
bg = 'transparent',
paper = 'special',
units = 'in',
useDingbats=FALSE,
compress = FALSE,
dpi = 300)
ggsave("~/GitHub/West Africa 2016/plots/2016-05-05_TFR.pdf",
width = 12, height = 4,
bg = 'transparent',
paper = 'special',
units = 'in',
useDingbats=FALSE,
compress = FALSE,
dpi = 300)
ggsave("~/GitHub/West Africa 2016/plots/2016-05-05_TFR.pdf",
width = 4*1.5, height = 4,
bg = 'transparent',
paper = 'special',
units = 'in',
useDingbats=FALSE,
compress = FALSE,
dpi = 300)
