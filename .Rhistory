panel.grid.minor.y = element_line(colour = grey60K, size = 0.1),
panel.ontop = TRUE)
ggplot(df, aes(x = causeCat,
y = mort,
fill = causeCat)) +
geom_bar(stat = 'identity') +
scale_fill_brewer(palette = 'Paired') +
scale_y_continuous(labels = scales::percent,
breaks = c(0, 0.25),
limits = c(0, 0.25),
minor_breaks = seq(0, 0.25, by = 0.05)) +
theme_ygrid() +
facet_wrap(~ country, ncol = 1) +
geom_text(aes(x = 6, y = 0.2,
label = country), hjust = 0,
colour = grey75K,
family = 'Segoe UI Light') +
geom_text(aes(label = percent(mort, 0)),
colour = grey90K,
nudge_y = -0.05,
size = 2,
family = 'Segoe UI') +
theme(strip.text = element_blank(),
panel.background = element_rect(fill = NA, colour = grey75K, size = 0.1),
axis.text.y = element_blank(),
axis.text.x = element_text(size = 8),
axis.title.y = element_blank(),
legend.position = 'bottom',
legend.direction = 'horizontal',
panel.grid.minor.y = element_line(colour = 'white', size = 0.1),
panel.ontop = TRUE)
ggplot(df, aes(x = causeCat,
y = mort,
fill = causeCat)) +
geom_bar(stat = 'identity') +
scale_fill_brewer(palette = 'Paired') +
scale_y_continuous(labels = scales::percent,
breaks = c(0, 0.25),
limits = c(0, 0.25),
minor_breaks = seq(0, 0.25, by = 0.05)) +
theme_ygrid() +
facet_wrap(~ country, ncol = 1) +
geom_text(aes(x = 6, y = 0.2,
label = country), hjust = 0,
colour = grey75K,
family = 'Segoe UI Light') +
geom_text(aes(label = percent(mort, 0)),
colour = grey90K,
nudge_y = -0.05,
size = 2,
family = 'Segoe UI') +
theme(strip.text = element_blank(),
panel.background = element_rect(fill = grey15K, colour = grey75K, size = 0.1),
axis.text.y = element_blank(),
axis.text.x = element_text(size = 8),
axis.title.y = element_blank(),
legend.position = 'bottom',
legend.direction = 'horizontal',
panel.grid.minor.y = element_line(colour = grey60K, size = 0.1))
ggplot(df, aes(x = causeCat,
y = mort,
fill = causeCat)) +
geom_bar(stat = 'identity') +
scale_fill_brewer(palette = 'Paired') +
scale_y_continuous(labels = scales::percent,
breaks = c(0, 0.25),
limits = c(0, 0.25),
minor_breaks = seq(0, 0.25, by = 0.1)) +
theme_ygrid() +
facet_wrap(~ country, ncol = 1) +
geom_text(aes(x = 6, y = 0.2,
label = country), hjust = 0,
colour = grey75K,
family = 'Segoe UI Light') +
geom_text(aes(label = percent(mort, 0)),
colour = grey90K,
nudge_y = -0.05,
size = 2,
family = 'Segoe UI') +
theme(strip.text = element_blank(),
panel.background = element_rect(fill = grey15K, colour = grey75K, size = 0.1),
axis.text.y = element_blank(),
axis.text.x = element_text(size = 8),
axis.title.y = element_blank(),
legend.position = 'bottom',
legend.direction = 'horizontal',
panel.grid.minor.y = element_line(colour = grey60K, size = 0.1))
ggplot(df, aes(x = causeCat,
y = mort,
fill = causeCat)) +
geom_bar(stat = 'identity') +
scale_fill_brewer(palette = 'Paired') +
scale_y_continuous(labels = scales::percent,
breaks = c(0, 0.25),
limits = c(0, 0.25),
minor_breaks = seq(0, 0.25, by = 0.1)) +
theme_ygrid() +
facet_wrap(~ country, ncol = 1) +
geom_text(aes(x = 6, y = 0.2,
label = country), hjust = 0,
colour = grey75K,
family = 'Segoe UI Light') +
geom_text(aes(label = percent(mort, 0)),
colour = grey90K,
nudge_y = -0.05,
size = 2,
family = 'Segoe UI') +
theme(strip.text = element_blank(),
panel.background = element_rect(fill = NA, colour = grey75K, size = 0.1),
axis.text.y = element_blank(),
axis.text.x = element_text(size = 8),
axis.title.y = element_blank(),
legend.position = 'bottom',
legend.direction = 'horizontal',
panel.grid.minor.y = element_line(colour = 'white', size = 0.1),
panel.ontop = TRUE)
ggplot(df, aes(x = causeCat,
y = mort,
fill = causeCat)) +
geom_bar(stat = 'identity') +
scale_fill_brewer(palette = 'Paired') +
scale_y_continuous(labels = scales::percent,
breaks = c(0, 0.25),
limits = c(0, 0.25),
minor_breaks = seq(0, 0.25, by = 0.1)) +
theme_ygrid() +
facet_wrap(~ country, ncol = 1) +
geom_text(aes(x = 6, y = 0.2,
label = country), hjust = 0,
colour = grey75K,
family = 'Segoe UI Light') +
geom_text(aes(label = percent(mort, 0)),
colour = grey90K,
nudge_y = -0.05,
size = 2,
family = 'Segoe UI') +
theme(strip.text = element_blank(),
panel.background = element_rect(fill = NA, colour = grey75K, size = 0.1),
axis.text.y = element_blank(),
axis.text.x = element_text(size = 8),
axis.title.y = element_blank(),
legend.position = 'bottom',
legend.direction = 'horizontal',
panel.grid.minor.y = element_line(colour = 'white', size = 0.3),
panel.ontop = TRUE)
ggplot(df, aes(x = causeCat,
y = mort,
fill = causeCat)) +
geom_bar(stat = 'identity') +
scale_fill_brewer(palette = 'Paired') +
scale_y_continuous(labels = scales::percent,
breaks = c(0, 0.25),
limits = c(0, 0.25),
minor_breaks = seq(0, 0.25, by = 0.1)) +
theme_ygrid() +
facet_wrap(~ country, ncol = 1) +
geom_text(aes(x = 6, y = 0.2,
label = country), hjust = 0,
colour = grey75K,
family = 'Segoe UI Light') +
geom_text(aes(label = percent(mort, 0)),
colour = grey90K,
nudge_y = -0.05,
size = 2,
family = 'Segoe UI') +
theme(strip.text = element_blank(),
panel.background = element_rect(fill = grey15K, colour = grey75K, size = 0.1),
axis.text.y = element_blank(),
axis.text.x = element_text(size = 8),
axis.title.y = element_blank(),
legend.position = 'bottom',
legend.direction = 'horizontal',
panel.grid.minor.y = element_line(colour = grey60K, size = 0.1),
panel.ontop = TRUE)
ggplot(df, aes(x = causeCat,
y = mort,
fill = causeCat)) +
geom_bar(stat = 'identity') +
scale_fill_brewer(palette = 'Paired') +
scale_y_continuous(labels = scales::percent,
breaks = c(0, 0.25),
limits = c(0, 0.25),
minor_breaks = seq(0, 0.25, by = 0.1)) +
theme_ygrid() +
facet_wrap(~ country, ncol = 1) +
geom_text(aes(x = 6, y = 0.2,
label = country), hjust = 0,
colour = grey75K,
family = 'Segoe UI Light') +
geom_text(aes(label = percent(mort, 0)),
colour = grey90K,
nudge_y = -0.05,
size = 2,
family = 'Segoe UI') +
theme(strip.text = element_blank(),
panel.background = element_rect(fill = grey15K, colour = grey75K, size = 0.1),
axis.text.y = element_blank(),
axis.text.x = element_text(size = 8),
axis.title.y = element_blank(),
legend.position = 'bottom',
legend.direction = 'horizontal',
panel.grid.minor.y = element_line(colour = grey60K, size = 0.1))
ggsave(filename = 'childMort.pdf',
width = 2.5, height = 11,
bg = 'transparent',
paper = 'special',
units = 'in',
useDingbats=FALSE,
compress = FALSE,
dpi = 300)
ggplot(df, aes(x = causeCat,
y = mort,
fill = causeCat)) +
geom_bar(stat = 'identity') +
scale_fill_brewer(palette = 'Paired') +
scale_y_continuous(labels = scales::percent,
breaks = c(0, 0.25),
limits = c(0, 0.25),
minor_breaks = seq(0, 0.25, by = 0.1)) +
theme_ygrid() +
facet_wrap(~ country, ncol = 1) +
geom_text(aes(x = 6, y = 0.2,
label = country), hjust = 0,
colour = grey75K,
family = 'Segoe UI Light') +
geom_text(aes(label = percent(mort, 0)),
colour = grey90K,
nudge_y = -0.05,
size = 2,
family = 'Segoe UI') +
theme(strip.text = element_blank(),
panel.background = element_rect(fill = grey15K, colour = grey75K, size = 0.1),
axis.text.y = element_blank(),
axis.text.x = element_text(size = 8),
axis.title.y = element_blank(),
legend.position = 'bottom',
legend.direction = 'horizontal',
panel.grid.minor.y = element_blank(),
panel.grid.major.y = element_blank())
# export ------------------------------------------------------------------
ggsave(filename = 'childMort.pdf',
width = 2.5, height = 11,
bg = 'transparent',
paper = 'special',
units = 'in',
useDingbats=FALSE,
compress = FALSE,
dpi = 300)
i = 1
library(llamar)
loadPkgs()
targetedCountries = c("Niger","Burkina Faso", "Cote d'Ivoire", "Cameroon", "Mauritania", "Togo", "Benin")
popPyramid = read.csv('~/Documents/USAID/West Africa Regional 2016/datain/2.1_PopulationPyramid.csv')
popPyramid = popPyramid %>%
rename(country = `X.Location`,
year = `X.Year`,
sex = `X.Sex`,
rural = `X.Area`,
total = `X.Total`) %>%
filter(year == 2015) %>%
gather(age, pop, -country, -year, -sex, -rural, -total)  # tidy
popPyramid = popPyramid %>%
mutate(pop = pop/1000, # Convert to millions of people
age = str_replace_all(age, 'X.', ''),
age = str_replace_all(age, '\\.', '-'),
age = ifelse(age == '80-', '80+', age),
pop = ifelse(sex == 'Male', pop * -1, pop)) # Hack to make two axes
popPyramid$age = factor(popPyramid$age,
levels = c('0-4','5-9','10-14','15-19','20-24','25-29',
'30-34','35-39','40-44','45-49','50-54','55-59','60-64','65-69','70-74','75-79', '80+'))
plotWidth = 6
plotHeight = 6
totalPop = popPyramid %>%
filter(rural == 'Total')
ggplot(totalPop %>% filter(sex =='Female'),
aes(x = age, y = pop,
fill = sex)) +
coord_flip() +
geom_bar(stat = 'identity', size = 0) +
geom_bar(stat = 'identity',
size = 0,
data = totalPop %>% filter(sex =='Male')) +
facet_wrap(~country) +
theme_xgrid()
totalPop = popPyramid %>%
filter(rural == 'Total',
country == targetedCountries[i])
ggplot(totalPop %>% filter(sex =='Female'),
aes(x = age, y = pop,
fill = sex)) +
coord_flip() +
geom_bar(stat = 'identity', size = 0) +
geom_bar(stat = 'identity',
size = 0,
data = totalPop %>% filter(sex =='Male')) +
facet_wrap(~country) +
scale_fill_manual(values = c('Male' = '#6AB2E2', 'Female' = '#9483BD')) +
theme_xgrid()
View(popPyramid)
popPyramid = read.csv('~/Documents/USAID/West Africa Regional 2016/datain/2.1_PopulationPyramid_UNPopulation.csv')
popPyramid = popPyramid %>%
rename(country = `X.Location`,
year = `X.Year`,
sex = `X.Sex`,
rural = `X.Area`,
total = `X.Total`) %>%
filter(year == 2015) %>%
gather(age, pop, -country, -year, -sex, -rural, -total)  # tidy
popPyramid = popPyramid %>%
mutate(pop = pop/1000, # Convert to millions of people
age = str_replace_all(age, 'X.', ''),
age = str_replace_all(age, '\\.', '-'),
age = ifelse(age == '80-', '80+', age),
pop = ifelse(sex == 'Male', pop * -1, pop)) # Hack to make two axes
# Change levels of age to be correct.
popPyramid$age = factor(popPyramid$age,
levels = c('0-4','5-9','10-14','15-19','20-24','25-29',
'30-34','35-39','40-44','45-49','50-54','55-59','60-64','65-69','70-74','75-79', '80+'))
plotWidth = 6
plotHeight = 6
totalPop = popPyramid %>%
filter(rural == 'Total')
ggplot(totalPop %>% filter(sex =='Female'),
aes(x = age, y = pop,
fill = sex)) +
coord_flip() +
geom_bar(stat = 'identity', size = 0) +
geom_bar(stat = 'identity',
size = 0,
data = totalPop %>% filter(sex =='Male')) +
facet_wrap(~country) +
theme_xgrid()
popPyramid = read.csv('~/Documents/USAID/West Africa Regional 2016/datain/2.1_PopulationPyramid_UNPopulation.csv')
popPyramid = popPyramid %>%
rename(country = `X.Location`,
year = `X.Year`,
sex = `X.Sex`,
rural = `X.Area`,
total = `X.Total`) %>%
filter(year == 2015) %>%
gather(age, pop, -country, -year, -sex, -rural, -total)  # tidy
popPyramid = popPyramid %>%
mutate(pop = pop/1000, # Convert to millions of people
age = str_replace_all(age, 'X.', ''),
age = str_replace_all(age, '\\.', '-'),
age = ifelse(age == '80-', '80+', age),
pop = ifelse(sex == 'Male', pop * -1, pop)) # Hack to make two axes
glimpse(popPyramid)
popPyramid = read.csv('~/Documents/USAID/West Africa Regional 2016/datain/2.1_PopulationPyramid_UNPopulation.csv')
glimpse(popPyramid)
popPyramid = popPyramid %>%
rename(country = `X.Location`,
year = `X.Year`,
sex = `X.Sex`,
rural = `X.Area`,
total = `X.Total`) %>%
filter(year == 2015) %>%
gather(age, pop, -country, -year, -sex, -rural, -total)  # tidy
popPyramid = popPyramid %>%
mutate(pop = pop/1000, # Convert to millions of people
age = str_replace_all(age, 'X.', ''),
age = str_replace_all(age, '\\.', '-'),
age = ifelse(age == '80-', '80+', age),
pop = ifelse(sex == 'Male', pop * -1, pop)) # Hack to make two axes
popPyramid$age = factor(popPyramid$age,
levels = c('0-4','5-9','10-14','15-19','20-24','25-29',
'30-34','35-39','40-44','45-49','50-54','55-59','60-64','65-69','70-74','75-79', '80+'))
plotWidth = 6
plotHeight = 6
totalPop = popPyramid %>%
filter(rural == 'Total')
ggplot(totalPop %>% filter(sex =='Female'),
aes(x = age, y = pop,
fill = sex)) +
coord_flip() +
scale_fill_manual(values = c('Male' = '#6AB2E2', 'Female' = '#9483BD')) +
geom_bar(stat = 'identity', size = 0) +
geom_bar(stat = 'identity',
size = 0,
data = totalPop %>% filter(sex =='Male')) +
facet_wrap(~country) +
theme_xgrid()
fileName = paste0('~/Documents/USAID/West Africa Regional 2016/plots/MF_pop_samescale.pdf')
ggsave(filename = fileName,
width = plotWidth, height = plotHeight,
bg = 'transparent',
paper = 'special',
units = 'in',
useDingbats=FALSE,
compress = FALSE,
dpi = 300)
# Load Libraries and data -------------------------------------------------
library(llamar)
loadPkgs()
targetedCountries = c("Niger","Burkina Faso", "Cote d'Ivoire", "Cameroon", "Mauritania", "Togo", "Benin")
# POPULATION PYRAMIDS -----------------------------------------------------
# Data from the UN URPAS http://www.un.org/en/development/desa/population/publications/dataset/urban/urbanAndRuralPopulationByAgeAndSex.shtml
# import pop pyramids -----------------------------------------------------
# Data initially in 1000's of people.
popPyramid = read.csv('~/Documents/USAID/West Africa Regional 2016/datain/2.1_PopulationPyramid_UNPopulation.csv')
popPyramid = popPyramid %>%
rename(country = `X.Location`,
year = `X.Year`,
sex = `X.Sex`,
rural = `X.Area`,
total = `X.Total`) %>%
filter(year == 2015) %>%
gather(age, pop, -country, -year, -sex, -rural, -total)  # tidy
popPyramid = popPyramid %>%
mutate(pop = pop/1000, # Convert to millions of people
age = str_replace_all(age, 'X.', ''),
age = str_replace_all(age, '\\.', '-'),
age = ifelse(age == '80-', '80+', age),
pop = ifelse(sex == 'Male', pop * -1, pop)) # Hack to make two axes
# Change levels of age to be correct.
popPyramid$age = factor(popPyramid$age,
levels = c('0-4','5-9','10-14','15-19','20-24','25-29',
'30-34','35-39','40-44','45-49','50-54','55-59','60-64','65-69','70-74','75-79', '80+'))
# pop pyramid plot --------------------------------------------------------
plotWidth = 6
plotHeight = 6
totalPop = popPyramid %>%
filter(rural == 'Total')
ggplot(totalPop %>% filter(sex =='Female'),
aes(x = age, y = pop,
fill = sex)) +
coord_flip() +
scale_fill_manual(values = c('Male' = '#6AB2E2', 'Female' = '#9483BD')) +
geom_bar(stat = 'identity', size = 0) +
geom_bar(stat = 'identity',
size = 0,
data = totalPop %>% filter(sex =='Male')) +
facet_wrap(~country) +
theme_xgrid()
fileName = paste0('~/Documents/USAID/West Africa Regional 2016/plots/MF_pop_samescale.pdf')
ggsave(filename = fileName,
width = plotWidth, height = plotHeight,
bg = 'transparent',
paper = 'special',
units = 'in',
useDingbats=FALSE,
compress = FALSE,
dpi = 300)
for (i in seq_along(targetedCountries)){
totalPop = popPyramid %>%
filter(rural == 'Total',
country == targetedCountries[i])
ggplot(totalPop %>% filter(sex =='Female'),
aes(x = age, y = pop,
fill = sex)) +
coord_flip() +
geom_bar(stat = 'identity', size = 0) +
geom_bar(stat = 'identity',
size = 0,
data = totalPop %>% filter(sex =='Male')) +
facet_wrap(~country) +
scale_fill_manual(values = c('Male' = '#6AB2E2', 'Female' = '#9483BD')) +
theme_xgrid()
fileName = paste0('~/Documents/USAID/West Africa Regional 2016/plots/MF_pop_',
targetedCountries[i], '.pdf')
ggsave(filename = fileName,
width = plotWidth, height = plotHeight,
bg = 'transparent',
paper = 'special',
units = 'in',
useDingbats=FALSE,
compress = FALSE,
dpi = 300)
}
# By urban/rural ----------------------------------------------------------
for (i in seq_along(targetedCountries)){
urbRuralPop = popPyramid %>%
filter(rural != 'Total',
country == targetedCountries[i])
p = ggplot(urbRuralPop %>% filter(sex =='Female'),
aes(x = age, y = pop,
fill = sex)) +
coord_flip() +
geom_bar(stat = 'identity', size = 0) +
geom_bar(stat = 'identity',
size = 0,
data = urbRuralPop %>% filter(sex =='Male')) +
geom_bar(stat = 'identity',
fill = 'white',
size = 0,
alpha = 0.5,
data = urbRuralPop %>%
filter(sex =='Male',
!age %in% c('10-14', '15-19', '20-24','25-29'))) +
geom_bar(stat = 'identity',
fill = 'white',
size = 0,
alpha = 0.5,
data = urbRuralPop %>%
filter(sex =='Female',
!age %in% c('10-14', '15-19', '20-24','25-29'))) +
scale_fill_manual(values = c('Male' = '#6AB2E2', 'Female' = '#9483BD')) +
facet_wrap(~rural, ncol = 2) +
theme_xgrid() +
theme(axis.title = element_blank()) +
ggtitle(targetedCountries[i])
fileName = paste0('~/Documents/USAID/West Africa Regional 2016/plots/UR_pop_',
targetedCountries[i], '.pdf')
ggsave(filename = fileName,
width = plotWidth, height = plotHeight,
bg = 'transparent',
paper = 'special',
units = 'in',
useDingbats=FALSE,
compress = FALSE,
dpi = 300)
}
